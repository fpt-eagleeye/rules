/*
   YARA Rule Set
   Author: yarGen Rule Generator
   Date: 2020-08-03
   Identifier: Avalance
   Reference: https://github.com/Neo23x0/yarGen
*/

/*
   Reference: https://www.phishlabs.com/cleaning-up-from-the-avalanche/
*/

/* Rule Set ----------------------------------------------------------------- */

rule sig_4931d6cca0ea250653784a1f1db82da5092c6c000396e7dd6ebf85d551c3da13 {
   meta:
      description = "Avalance - file 4931d6cca0ea250653784a1f1db82da5092c6c000396e7dd6ebf85d551c3da13"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2020-08-03"
      hash1 = "4931d6cca0ea250653784a1f1db82da5092c6c000396e7dd6ebf85d551c3da13"
   strings:
      $s1 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s2 = "w4-gb.exe" fullword wide
      $s3 = "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"/>" fullword ascii
      $s4 = "  <assemblyIdentity version=\"1.0.0.0\" name=\"MyApplication.app\"/>" fullword ascii
      $s5 = "jwjdnosriba" fullword wide
      $s6 = "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v2\">" fullword ascii
      $s7 = "jwjdnosriba.resources" fullword ascii
      $s8 = "<PrivateImplementationDetails>{E8D2E75A-FF1B-4091-8BC1-4021F1D0050B}" fullword ascii
      $s9 = "Stub.Program" fullword wide
      $s10 = "bytesToBeDecrypted" fullword ascii
      $s11 = "      <requestedPrivileges xmlns=\"urn:schemas-microsoft-com:asm.v3\">" fullword ascii
      $s20 = "39efea4d13cd" ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule sig_577043fc24ceb096da85bb8d60aa6acb0c2c42fefc5fc5d9adcdb8edcbcf9fbd {
   meta:
      description = "Avalance - file 577043fc24ceb096da85bb8d60aa6acb0c2c42fefc5fc5d9adcdb8edcbcf9fbd"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2020-08-03"
      hash1 = "577043fc24ceb096da85bb8d60aa6acb0c2c42fefc5fc5d9adcdb8edcbcf9fbd"
   strings:
      $s1 = "TCQJOSb2" fullword ascii
      $s2 = "j*Q -^" fullword ascii
      $s4 = "eumWRaP)" fullword ascii
      $s5 = "~WjULmpDpT" fullword ascii
      $s6 = "IyJEkd3j" fullword ascii
      $s7 = "cXSGR\"" fullword ascii
      $s8 = "TjCfu\\" fullword ascii
      $s9 = "\"lnvaE!#" fullword ascii
      $s10 = "qNDBGgM" fullword ascii
      $s11 = "naSC|S~$" fullword ascii
      $s12 = "kuWJ{.6" fullword ascii
      $s13 = "vWFx_m3" fullword ascii
      $s14 = "XIvj1!C" fullword ascii
      $s15 = "\\hM SXg5" fullword ascii
      $s16 = "\\cG\\#|\\b" fullword ascii
      $s17 = "\\)5lft" fullword ascii
      $s20 = "`L`\\<F" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 500KB and
      8 of them
}

/* Super Rules ------------------------------------------------------------- */

